{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nexport function useMedia(query) {\n  _s();\n\n  if (!true) {\n    return false;\n  }\n\n  var media = useMemo(function () {\n    return window.matchMedia(query);\n  }, [query]);\n\n  var _useState = useState(media.matches),\n      state = _useState[0],\n      setState = _useState[1];\n\n  useEffect(function () {\n    var onChangeMedia = function onChangeMedia() {\n      setState(media.matches);\n    };\n\n    if (media.addEventListener) {\n      media.addEventListener('change', onChangeMedia);\n    } else {\n      // noinspection JSDeprecatedSymbols\n      media.addListener(onChangeMedia);\n    }\n\n    return function () {\n      if (media.removeEventListener) {\n        media.removeEventListener('change', onChangeMedia);\n      } else {\n        // noinspection JSDeprecatedSymbols\n        media.removeListener(onChangeMedia);\n      }\n    };\n  }, [media]);\n  return state;\n}\n\n_s(useMedia, \"dz8zGlMDf1DZVh+Qs/z4IR6EM3M=\");\n\nexport function useDeferredData(source, defaultData, initialData) {\n  _s2();\n\n  var deps = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];\n\n  var _useState2 = useState(function () {\n    return {\n      isLoading: initialData === undefined,\n      data: initialData || defaultData\n    };\n  }),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var memoizedSource = useCallback(source, deps);\n  var skipNextRef = useRef(initialData !== undefined);\n  useEffect(function () {\n    if (skipNextRef.current) {\n      skipNextRef.current = false;\n      return function () {};\n    }\n\n    var canceled = false;\n    setState(function (curState) {\n      if (!curState.isLoading) {\n        return _objectSpread(_objectSpread({}, curState), {}, {\n          isLoading: true\n        });\n      }\n\n      return curState;\n    });\n    memoizedSource().then(function (data) {\n      if (canceled) {\n        return;\n      }\n\n      setState(function () {\n        return {\n          isLoading: false,\n          data: data\n        };\n      });\n    });\n    return function () {\n      canceled = true;\n    };\n  }, [memoizedSource]);\n  return state;\n}\n\n_s2(useDeferredData, \"nFFxTPgIfY3M/FcZjgaCwJcYCBs=\");\n\nexport function useProductTabs(tabs, productsSource, initialData) {\n  _s3();\n\n  var _useState3 = useState(1),\n      currentTabId = _useState3[0],\n      setCurrentTabId = _useState3[1];\n\n  var memoizedTabs = useMemo(function () {\n    return tabs.map(function (tab) {\n      return _objectSpread(_objectSpread({}, tab), {}, {\n        current: currentTabId === tab.id\n      });\n    });\n  }, [tabs, currentTabId]);\n  var currentTab = memoizedTabs.find(function (x) {\n    return x.current;\n  });\n  var products = useDeferredData(function () {\n    return currentTab ? productsSource(currentTab) : Promise.resolve([]);\n  }, [], initialData, [currentTab]);\n  var handleTabChange = useCallback(function (tab) {\n    setCurrentTabId(tab.id);\n  }, [setCurrentTabId]);\n  return useMemo(function () {\n    return _objectSpread({\n      tabs: memoizedTabs,\n      handleTabChange: handleTabChange\n    }, products);\n  }, [memoizedTabs, handleTabChange, products]);\n}\n\n_s3(useProductTabs, \"ruf1/dY4UnT/4/SSFFFaJa8b3iY=\", false, function () {\n  return [useDeferredData];\n});\n\nexport function useProductColumns(columns) {\n  _s4();\n\n  var products = useDeferredData(function () {\n    return Promise.all(columns.map(function (column) {\n      return column.source();\n    }));\n  }, [], undefined, [columns]);\n  return useMemo(function () {\n    return columns.map(function (column, index) {\n      return _objectSpread(_objectSpread({}, column), {}, {\n        products: products.data[index] || []\n      });\n    });\n  }, [columns, products]);\n}\n\n_s4(useProductColumns, \"nhBtKPM1Vs/7/fgpaIJ6Yetg/v8=\", false, function () {\n  return [useDeferredData];\n});","map":{"version":3,"sources":["D:/xampp/htdocs/neo.co.th/nextapp/src/services/hooks.ts"],"names":["useCallback","useEffect","useMemo","useRef","useState","useMedia","query","media","window","matchMedia","matches","state","setState","onChangeMedia","addEventListener","addListener","removeEventListener","removeListener","useDeferredData","source","defaultData","initialData","deps","isLoading","undefined","data","memoizedSource","skipNextRef","current","canceled","curState","then","useProductTabs","tabs","productsSource","currentTabId","setCurrentTabId","memoizedTabs","map","tab","id","currentTab","find","x","products","Promise","resolve","handleTabChange","useProductColumns","columns","all","column","index"],"mappings":"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","sourcesContent":["import {\n    useCallback,\n    useEffect,\n    useMemo, useRef,\n    useState,\n} from 'react';\nimport { IProduct } from '../interfaces/product';\n\nexport function useMedia(query: string) {\n    if (!process.browser) {\n        return false;\n    }\n\n    const media = useMemo(() => window.matchMedia(query), [query]);\n    const [state, setState] = useState(media.matches);\n\n    useEffect(() => {\n        const onChangeMedia = () => {\n            setState(media.matches);\n        };\n\n        if (media.addEventListener) {\n            media.addEventListener('change', onChangeMedia);\n        } else {\n            // noinspection JSDeprecatedSymbols\n            media.addListener(onChangeMedia);\n        }\n\n        return () => {\n            if (media.removeEventListener) {\n                media.removeEventListener('change', onChangeMedia);\n            } else {\n                // noinspection JSDeprecatedSymbols\n                media.removeListener(onChangeMedia);\n            }\n        };\n    }, [media]);\n\n    return state;\n}\n\nexport type DeferredDataSource<T> = () => Promise<T>;\nexport type DeferredDataState<T> = { isLoading: boolean, data: T };\n\nexport function useDeferredData<T>(\n    source: DeferredDataSource<T>,\n    defaultData: T,\n    initialData?: T,\n    deps: any[] = [],\n): DeferredDataState<T> {\n    const [state, setState] = useState(() => ({\n        isLoading: initialData === undefined,\n        data: initialData || defaultData,\n    }));\n    const memoizedSource = useCallback(source, deps);\n    const skipNextRef = useRef(initialData !== undefined);\n\n    useEffect(() => {\n        if (skipNextRef.current) {\n            skipNextRef.current = false;\n\n            return () => {};\n        }\n\n        let canceled = false;\n\n        setState((curState) => {\n            if (!curState.isLoading) {\n                return { ...curState, isLoading: true };\n            }\n\n            return curState;\n        });\n\n        memoizedSource().then((data) => {\n            if (canceled) {\n                return;\n            }\n\n            setState(() => ({ isLoading: false, data }));\n        });\n\n        return () => {\n            canceled = true;\n        };\n    }, [memoizedSource]);\n\n    return state;\n}\n\nexport type ProductTab = { id: number; name: string };\nexport type WithCurrent<T> = T & {current: boolean};\nexport type ProductTabSource<T extends ProductTab> = (tab: T) => Promise<IProduct[]>;\nexport type ProductTabsState<T extends ProductTab> = {\n    tabs: WithCurrent<T>[];\n    handleTabChange: (tab: WithCurrent<T>) => void;\n} & DeferredDataState<IProduct[]>;\n\nexport function useProductTabs<T extends ProductTab>(\n    tabs: T[],\n    productsSource: ProductTabSource<T>,\n    initialData?: IProduct[],\n): ProductTabsState<T> {\n    const [currentTabId, setCurrentTabId] = useState(1);\n    const memoizedTabs = useMemo(() => (\n        tabs.map((tab) => ({\n            ...tab,\n            current: currentTabId === tab.id,\n        }))\n    ), [tabs, currentTabId]);\n    const currentTab = memoizedTabs.find((x) => x.current);\n    const products = useDeferredData(() => (\n        currentTab ? productsSource(currentTab) : Promise.resolve([])\n    ), [], initialData, [currentTab]);\n    const handleTabChange = useCallback((tab) => {\n        setCurrentTabId(tab.id);\n    }, [setCurrentTabId]);\n\n    return useMemo(() => ({\n        tabs: memoizedTabs,\n        handleTabChange,\n        ...products,\n    }), [memoizedTabs, handleTabChange, products]);\n}\n\nexport type ProductColumn = {\n    title: string;\n    source: DeferredDataSource<IProduct[]>;\n};\n\nexport function useProductColumns(columns: ProductColumn[]) {\n    const products = useDeferredData(() => (\n        Promise.all(columns.map((column) => column.source()))\n    ), [], undefined, [columns]);\n\n    return useMemo(() => (\n        columns.map((column, index) => ({\n            ...column,\n            products: products.data[index] || [],\n        }))\n    ), [columns, products]);\n}\n"]},"metadata":{},"sourceType":"module"}