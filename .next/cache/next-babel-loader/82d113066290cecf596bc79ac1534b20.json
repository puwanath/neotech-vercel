{"ast":null,"code":"import CategoryFilterBuilder from '../filters/category';\nimport CheckFilterBuilder from '../filters/check';\nimport ColorFilterBuilder from '../filters/color';\nimport productsData from '../database/products';\nimport RadioFilterBuilder from '../filters/radio';\nimport RangeFilterBuilder from '../filters/range';\nimport { delayResponse } from '../utils';\n\nfunction getProducts(shift, options) {\n  const limit = options.limit || 8;\n  let products = [...productsData.slice(shift), ...productsData.slice(0, shift)];\n\n  if (options.category === 'power-tools') {\n    products = products.slice().reverse();\n  } else if (options.category === 'hand-tools') {\n    products = [...products.slice(8), ...products.slice(0, 8)];\n  } else if (options.category === 'plumbing') {\n    products = [...products.slice(8), ...products.slice(0, 8)].reverse();\n  }\n\n  return delayResponse(350, products.slice(0, limit));\n}\n\nexport function getProductBySlug(slug) {\n  const product = productsData.find(x => x.slug === slug);\n  return product ? Promise.resolve(product) : Promise.reject();\n}\nexport function getRelatedProducts(slug, options = {}) {\n  const limit = options.limit || 8;\n  return Promise.resolve(productsData.slice(0, limit));\n}\nexport function getProductsList(options = {}, filterValues = {}) {\n  const filters = [new CategoryFilterBuilder('category', 'Categories'), new RangeFilterBuilder('price', 'Price'), new CheckFilterBuilder('brand', 'Brand'), new RadioFilterBuilder('discount', 'Discount'), new ColorFilterBuilder('color', 'Color')];\n  let items = productsData.slice(0);\n  filters.forEach(filter => filter.makeItems(items, filterValues[filter.slug])); // Calculate items count for filter values.\n\n  filters.forEach(filter => filter.calc(filters)); // Apply filters to products list.\n\n  items = items.filter(product => filters.reduce((mr, filter) => mr && filter.test(product), true));\n  const page = options.page || 1;\n  const limit = options.limit || 12;\n  const sort = options.sort || 'default';\n  const total = items.length;\n  const pages = Math.ceil(total / limit);\n  const from = (page - 1) * limit + 1;\n  const to = Math.max(Math.min(page * limit, total), from);\n  items = items.sort((a, b) => {\n    if (['name_asc', 'name_desc'].includes(sort)) {\n      if (a.name === b.name) {\n        return 0;\n      }\n\n      return (a.name > b.name ? 1 : -1) * (sort === 'name_asc' ? 1 : -1);\n    }\n\n    return 0;\n  });\n  const start = (page - 1) * limit;\n  const end = start + limit;\n  items = items.slice(start, end);\n  return delayResponse(350, {\n    page,\n    limit,\n    sort,\n    total,\n    pages,\n    from,\n    to,\n    items,\n    filters: filters.map(x => x.build())\n  });\n}\nexport function getFeaturedProducts(options = {}) {\n  return getProducts(0, options);\n}\nexport function getLatestProducts(options = {}) {\n  return getProducts(0, options);\n}\nexport function getTopRatedProducts(options = {}) {\n  return getProducts(0, options);\n}\nexport function getDiscountedProducts(options = {}) {\n  return getProducts(3, options);\n}\nexport function getPopularProducts(options = {}) {\n  return getProducts(6, options);\n}\nexport function getSuggestions(query, options) {\n  const limit = options.limit || 5;\n  return Promise.resolve(productsData.filter(x => x.name.toLowerCase().includes(query.toLowerCase())).slice(0, limit));\n}\nexport function getCategoryLists(query, options) {\n  const limit = options.limit || 5;\n  return Promise.resolve(productsData.filter(x => x.name.toLowerCase().includes(query.toLowerCase())).slice(0, limit));\n}","map":{"version":3,"sources":["D:/xampp/htdocs/neo.co.th/nextapp/src/fake-server/endpoints/products.ts"],"names":["CategoryFilterBuilder","CheckFilterBuilder","ColorFilterBuilder","productsData","RadioFilterBuilder","RangeFilterBuilder","delayResponse","getProducts","shift","options","limit","products","slice","category","reverse","getProductBySlug","slug","product","find","x","Promise","resolve","reject","getRelatedProducts","getProductsList","filterValues","filters","items","forEach","filter","makeItems","calc","reduce","mr","test","page","sort","total","length","pages","Math","ceil","from","to","max","min","a","b","includes","name","start","end","map","build","getFeaturedProducts","getLatestProducts","getTopRatedProducts","getDiscountedProducts","getPopularProducts","getSuggestions","query","toLowerCase","getCategoryLists"],"mappings":"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","sourcesContent":["import CategoryFilterBuilder from '../filters/category';\nimport CheckFilterBuilder from '../filters/check';\nimport ColorFilterBuilder from '../filters/color';\nimport productsData from '../database/products';\nimport RadioFilterBuilder from '../filters/radio';\nimport RangeFilterBuilder from '../filters/range';\nimport { IProduct, IProductsList } from '../../interfaces/product';\nimport { delayResponse } from '../utils';\n\nexport interface GetProductsOptions {\n    limit?: number;\n    category?: string;\n}\n\nexport interface GetProductsListOptions {\n    page?: number;\n    limit?: number;\n    sort?: string;\n}\n\nexport interface GetProductsListFilters {\n    [filterSlug: string]: string;\n}\n\nexport type GetSuggestionsOptions = {\n    limit?: number;\n    category?: string;\n};\nexport type GetCategoryLists = {\n    limit?: number;\n    category?: string;\n};\n\nfunction getProducts(shift: number, options: GetProductsOptions): Promise<IProduct[]> {\n    const limit = options.limit || 8;\n    let products = [...productsData.slice(shift), ...productsData.slice(0, shift)];\n\n    if (options.category === 'power-tools') {\n        products = products.slice().reverse();\n    } else if (options.category === 'hand-tools') {\n        products = [...products.slice(8), ...products.slice(0, 8)];\n    } else if (options.category === 'plumbing') {\n        products = [...products.slice(8), ...products.slice(0, 8)].reverse();\n    }\n\n    return delayResponse(350, products.slice(0, limit));\n}\n\nexport function getProductBySlug(slug: string) {\n    const product = productsData.find((x) => x.slug === slug);\n\n    return product ? Promise.resolve(product) : Promise.reject();\n}\n\nexport function getRelatedProducts(slug: string, options: GetProductsOptions = {}) {\n    const limit = options.limit || 8;\n\n    return Promise.resolve(productsData.slice(0, limit));\n}\n\nexport function getProductsList(\n    options: GetProductsListOptions = {},\n    filterValues: GetProductsListFilters = {},\n): Promise<IProductsList> {\n    const filters = [\n        new CategoryFilterBuilder('category', 'Categories'),\n        new RangeFilterBuilder('price', 'Price'),\n        new CheckFilterBuilder('brand', 'Brand'),\n        new RadioFilterBuilder('discount', 'Discount'),\n        new ColorFilterBuilder('color', 'Color'),\n    ];\n\n    let items = productsData.slice(0);\n\n    filters.forEach((filter) => filter.makeItems(items, filterValues[filter.slug]));\n\n    // Calculate items count for filter values.\n    filters.forEach((filter) => filter.calc(filters));\n\n    // Apply filters to products list.\n    items = items.filter(\n        (product) => filters.reduce<boolean>((mr, filter) => mr && filter.test(product), true),\n    );\n\n    const page = options.page || 1;\n    const limit = options.limit || 12;\n    const sort = options.sort || 'default';\n    const total = items.length;\n    const pages = Math.ceil(total / limit);\n    const from = (page - 1) * limit + 1;\n    const to = Math.max(Math.min(page * limit, total), from);\n\n    items = items.sort((a, b) => {\n        if (['name_asc', 'name_desc'].includes(sort)) {\n            if (a.name === b.name) {\n                return 0;\n            }\n\n            return (a.name > b.name ? 1 : -1) * (sort === 'name_asc' ? 1 : -1);\n        }\n\n        return 0;\n    });\n\n    const start = (page - 1) * limit;\n    const end = start + limit;\n\n    items = items.slice(start, end);\n\n    return delayResponse(350, {\n        page,\n        limit,\n        sort,\n        total,\n        pages,\n        from,\n        to,\n        items,\n        filters: filters.map((x) => x.build()),\n    });\n}\n\nexport function getFeaturedProducts(options = {}) {\n    return getProducts(0, options);\n}\n\nexport function getLatestProducts(options = {}) {\n    return getProducts(0, options);\n}\n\nexport function getTopRatedProducts(options = {}) {\n    return getProducts(0, options);\n}\n\nexport function getDiscountedProducts(options = {}) {\n    return getProducts(3, options);\n}\n\nexport function getPopularProducts(options = {}) {\n    return getProducts(6, options);\n}\n\nexport function getSuggestions(query: string, options: GetSuggestionsOptions) {\n    const limit = options.limit || 5;\n\n    return Promise.resolve(\n        productsData.filter(\n            (x) => x.name.toLowerCase().includes(query.toLowerCase()),\n        ).slice(0, limit),\n    );\n}\n\nexport function getCategoryLists(query: string, options: GetCategoryLists) {\n    const limit = options.limit || 5;\n\n    return Promise.resolve(\n        productsData.filter(\n            (x) => x.name.toLowerCase().includes(query.toLowerCase()),\n        ).slice(0, limit),\n    );\n}\n"]},"metadata":{},"sourceType":"module"}